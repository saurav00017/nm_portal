import csv
import os
from re import X
from xxlimited import Xxo
from college.models import College
from django.conf import settings
from datetime import datetime
from student.models import Student
from django.db.models import Count


colleges_list = ['8156', '8127', '8158', '8148', '4103', '4204', '3128', '3101', '3129', '4104', '4208', '7219', '3108',
                 '3120', '3109', '3110', '4212', '3112', '3116', '3131', '3117', '4114', '4115', '4116', '3121', '4123',
                 '4125', '4124', '3122', '4128', '3123', '3124', '3125', '4127', '3126', '13', '4129', '1138', '1407',
                 '1435', '1301', '3103', '-', '3107', '3111', '3113', '3114', '3115', '14', '12', '1', '7101', '7203',
                 '7100', '7239', '7153', '7104', '7204', '7105', '7176', '7240', '3105', '7276', '7107', '7205', '7177',
                 '7207', '7208', '7243', '7110', '7111', '7209', '7178', '7212', '7116', '7117', '7115', '7113', 'AU',
                 '7210', '7244', '7217', '7122', '7123', '7236', '7125', '7180', '7155', '7129', '7130', '7246', '7218',
                 '7128', '7245', '7133', '7135', '7136', '7228', '7277', '7278', '7181', '7138', '7139', '7131', '7211',
                 '7150', '7221', '7142', '7143', '7157', '7145', '7237', '2729', '2778', '2361', '2364', '2727', '4207',
                 '8106', '4213', '8224', '4221', '4226', '5', '6135', '6109', '6110', '6120', '6226', '6128', '9203',
                 '9208', '9213', '9214', '7147', '9216', '9221', '9223', '5544', '5538', '5537', '5913', '5720', '5851',
                 '9215', '7301', '7302', '7376', '7304', '7311', '7312', '7378', '7317', '7321', '7322', '7325',
                 '7328', '7329', '4201', '4206', '6211', '6214', '6229', '4101', '4130', '2102', '2103', '2104', '4106',
                 '4107', '2105', '5110', '2106', '2108', '2109', '2111', '2112', '2113', '5115', '5117', '2131', '4117',
                 '2116', '2117', '2118', '2119', '4118', '2122', '4120', '4121', '2126', '2127', '4126', '2129', '5132',
                 '5134', '1205', '1532', '9623', '9601', '9602', '9603', '9604', '9606', '9638', '9607', '9609', '9611',
                 '9636', '9612', '9614', '9616', '9613', '9617', '9618', '9619', '9633', '9621', '9622', '9635', '9626',
                 '9628', '9630', '9629', '4927', '4943', '4671', '9230', '9202', '9207', '9209', '9225', '6176', '6108',
                 '6107', '6118', '9100', '9104', '9110', '9238', '9119', '9123', '9122', '9177', '9129', '9133', '1132',
                 '8226', '8203', '8208', '8215', '8216', '8217', '8222', '6202', '6205', '7306', '7307', '7309', '6207',
                 '6208', '7313', '7315', '7316', '7377', '6113', '6114', '6116', '6217', '6216', '6220', '6221', '6222',
                 '6218', '7323', '6225', '6122', '6123', '6227', '7331', '6129', '6130', '2638', '2665', '8104', '8135',
                 '8154', '9103', '8211', '9112', '9114', '8128', '9116', '9117', '9124', '9126', '8144', '9105', '9155',
                 '9128', '9130', '5101', '5135', '5106', '5109', '5121', '1123', '1147', '6102', '6235', '6201', '6203',
                 '6105', '6206', '6177', '6236', '6112', '6215', '6117', '6224', '6124', '6178', '7327', '6230', '6127',
                 '6231', '9176', '9102', '9107', '9108', '9106', '9120', '9125', '9127', '5922', '9512', '9526', '9527',
                 '9501', '4998', '8205', '8206', '8207', '8227', '8210', '8212', '8213', '8218', '8219', '8220', '8221',
                 '8223', '7106', '7121', '9201', '9233', '9210', '9222', '5105', '5118', '5119', '1102', '1101', '2101',
                 '1105', '1103', '1106', '1107', '2128', '1108', '1111', '1120', '2114', '2115', '1116', '1118', '1115',
                 '1113', '1135', '1119', '1114', '2120', '2124', '1138', '1126', '1124', '1116', '1127', '1128', '1133',
                 '1131', '1152', '1304', '1110', '1124', '1118', '1120', '5102', '5103', '5104', '5114', '5122', '5127',
                 '5133', '4223', '8204', '8201', '9504', '9505', '9503', '9509', '9510', '9576', '9530', '9532', '9533',
                 '9534', '4957', '8101', '8107', '8301', '8110', '8112', '8113', '8114', '8115', '8117', '6213', '8118',
                 '8124', '8126', '8121', '8119', '8125', '8129', '8131', '8159', '8138', '8139', '8142', '8147', '8155',
                 '8146', '8100', '6233', '3829', '3813', '3453', '9500', '9605', '9506', '9507', '9508', '9518', '9632',
                 '9522', '9523', '9524', '9528', '9627', '9531', '7103', '7303', '7112', '7333', '7324', '5108',
                 '5113', '5126', '5131', '4203', '4211', '4216', '4210', '4218', '4220', '4222', '4225', '4224', '4227',
                 '9537', '9515', '9204', '9517', '9519', '9520', '9536', '9218', '9220', '4917', '9535', '4979']

print("count of the colleges in excel ",len(colleges_list))

present = []


not_present = []

for x in colleges_list:
      try:
            college_info = College.objects.get(college_code=x)
            present.append(college_info.college_code)
      except College.DoesNotExist:
            not_present.append(x)

print(len(present))

print(len(not_present))


print(
      not_present
)



# test
# header = ['college_code', 'college_name', 'email', 'mobile', 'status', 'student_count', 'college_type']
#
# file_name = "zcolleges_not_in_final" + str(datetime.now().strftime("%H:%M:%S")) + ".csv"
#
# with open(file_name, 'w', encoding='UTF8', newline='') as f:
#     writer = csv.writer(f)
#     writer.writerow(header)
#     for college_info in all_colleges:
#         data = [college_info.college_code, college_info.college_name,
#                 college_info.email, college_info.mobile,
#                 college_info.status, Student.objects.filter(college_id=college_info.id).count(),
#                 college_info.college_type]
#         writer.writerow(data)


"""
# finding duplicates
all_codes = []
count = 0
count1 = 0
count2 = 0
for x in College.objects.all():
      count = count + 1
      if x.college_code is not all_codes: 
            all_codes.append(x.college_code)
            count1 = count1 + 1
      elif x.college_code in all_codes:
            print(x.college_code)
            count2 = count2 + 1

print(count,count1,count2)

"""