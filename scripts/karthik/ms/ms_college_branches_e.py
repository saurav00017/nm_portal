from student.models import Student
from college.models import College
import csv
import os
from django.conf import  settings

colleges_data = []

header = ['College Code', 'Branch Id', 'Students Count']

college_list = ["1101","1105","1108","1111","1120","1123","1124","1125","1126","1127","1128","1133","2101","2102","2105","2106","2109","2111","2113","2117","2119","2120","2124","2126","2128","1114","2115","2129","5134","1106","2112","1","2104","1107","1138","2108","3101","3107","3108","3110","3115","3116","3118","3128","3105","3114","3111","3103","3121","3125","4101","4103","4106","4107","4108","4114","4115","4116","4117","4118","4120","4121","4123","4126","4127","4130","4","3126","1103","3","4119","4129","4204","4208","4212","4216","4218","4220","4223","4224","5104","5122","5101","5102","5103","5106","5108","5109","5110","5113","5114","5115","5117","5121","6107","5126","5127","5131","5132","5133","5135","5105","5118","5119","6105","6108","6109","6110","6117","6118","6120","6126","6127","6128","6135","6226","6102","6112","6114","6115","6124","6201","6202","6203","6205","6206","6207","6208","6215","6217","6218","6220","6222","6224","6225","6227","6230","6231","6233","6235","6236","6177","7100","7101","7103","7104","7106","7110","7111","7112","7116","7117","7122","7123","7125","7128","7129","7131","7136","7139","7142","7145","7150","7153","7155","7203","7204","7205","7209","7210","7211","7212","7214","7218","7219","7236","7237","7239","7240","6122","6130","7301","7303","7307","7311","7312","7313","7316","7317","7321","7323","7324","7325","7327","7328","7331","7333","8106","8120","8121","8126","8127","8135","8142","8146","8147","8148","8150","8151","8154","8155","8156","8158","7177","8201","8203","8204","8205","8206","8207","8210","8211","8212","8213","8216","8217","8218","8219","8220","8221","8222","8223","8226","8227","9103","9104","9105","9108","9112","9114","9115","9116","9117","9120","9124","9125","9126","9127","9128","9130","9132","9201","9202","9203","9208","9209","9210","9212","9214","9215","9216","9219","9221","9222","9223","9225","9230","9233","9236","9501","9506","9508","9512","9516","9520","9523","9524","9525","9526","9527","9528","9531","9533","9535","9176","9102","4201","4203","4206","4207","4213","4221","4222","4225","4226","4227","6211","6214","6229","8224","8100","8107","8110","8112","8113","8114","8118","8124","8125","8128","8129","8130","8131","8138","8139","8144","8301","9100","9107","9110","9119","9122","9123","9129","9131","9133","9218","9220","9238","9536","9537","9601","9602","9603","9604","9607","9611","9612","9614","9615","9616","9617","9618","9619","9621","9622","9623","9626","9628","9629","9635","9636","9638","9500","9503","9504","9505","9509","9510","9513","9518","9530","9532","9534","9605","9606","9609","9613","9620","9627","9632","9633"]

print(len(college_list))
with open(os.path.join(settings.BASE_DIR, 'scripts/karthik/ms/colleges_data.csv'), 'w') as f:
    writer = csv.writer(f)
    writer.writerow(header)
    for c in college_list:
        students = Student.objects.filter(college__college_code=c, sem=3)
        branch_ids = students.values_list('rbranch_id', flat=True).distinct('rbranch_id')
        for branch in branch_ids:
            students_count = students.filter(rbranch_id=branch).count()
            writer.writerow([c, branch, students_count])
